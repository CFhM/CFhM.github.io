<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="第二期第四次每周训练题解   Authored by CFhM_R, 2011 - 2017, All Rights Reserved.   CFhM_R@outlook.com  [TOC] A-Moon Safari (medium)-数论 $\displaystyle{\quad dp[n][r]\=\sum{i = 1}^{n}a^ii^r\=\sum{i=0}^{n-1}a^{i+1}(">
<meta property="og:type" content="article">
<meta property="og:title" content="test">
<meta property="og:url" content="http://yoursite.com/2017/09/11/test/index.html">
<meta property="og:site_name" content="CFhM_R&#39;s Blog">
<meta property="og:description" content="第二期第四次每周训练题解   Authored by CFhM_R, 2011 - 2017, All Rights Reserved.   CFhM_R@outlook.com  [TOC] A-Moon Safari (medium)-数论 $\displaystyle{\quad dp[n][r]\=\sum{i = 1}^{n}a^ii^r\=\sum{i=0}^{n-1}a^{i+1}(">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-09-11T03:24:32.391Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="test">
<meta name="twitter:description" content="第二期第四次每周训练题解   Authored by CFhM_R, 2011 - 2017, All Rights Reserved.   CFhM_R@outlook.com  [TOC] A-Moon Safari (medium)-数论 $\displaystyle{\quad dp[n][r]\=\sum{i = 1}^{n}a^ii^r\=\sum{i=0}^{n-1}a^{i+1}(">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/09/11/test/"/>





  <title>test | CFhM_R's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">CFhM_R's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/11/test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="CFhM_R">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CFhM_R's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">test</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-11T11:22:41+08:00">
                2017-09-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="第二期第四次每周训练题解"><a href="#第二期第四次每周训练题解" class="headerlink" title="第二期第四次每周训练题解"></a>第二期第四次每周训练题解</h1><blockquote>
<p>  Authored by CFhM_R, 2011 - 2017, All Rights Reserved.</p>
<p>  <a href="my mail">CFhM_R@outlook.com</a></p>
</blockquote>
<p>[TOC]</p>
<h2 id="A-Moon-Safari-medium-数论"><a href="#A-Moon-Safari-medium-数论" class="headerlink" title="A-Moon Safari (medium)-数论"></a>A-Moon Safari (medium)-数论</h2><ul>
<li>$\displaystyle{\quad dp[n][r]\=\sum<em>{i = 1}^{n}a^ii^r\=\sum</em>{i=0}^{n-1}a^{i+1}(i+1)^r\=a\sum<em>{i=0}^{n-1}a^i\sum</em>{k=0}^rC<em>{r}^{k}i^k\=a\sum</em>{i=1}^{n-1}a^i\sum<em>{k=0}^rC</em>{r}^{k}i^k\=a\sum<em>{k=0}^rC</em>{r}^{k}\sum<em>{i=1}^{n-1}a^ii^k\=a\sum</em>{k=0}^rC_{r}^{k}dp[n-1][k]}$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sboj卡常卡不过</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"><span class="keyword">const</span> LL mod = <span class="number">1e9</span> + <span class="number">7</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">446</span>;</div><div class="line">LL C[maxn][maxn];</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span></span></div><div class="line"><span class="class">&#123;</span></div><div class="line">    LL m[maxn][maxn];</div><div class="line">    Matrix()&#123;<span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="keyword">sizeof</span>(m));&#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">E</span><span class="params">()</span></span>&#123;<span class="built_in">memset</span>(m, <span class="number">0</span>, <span class="keyword">sizeof</span>(m)); <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++) m[i][i] = <span class="number">1</span>;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function">Matrix <span class="title">M_mul</span><span class="params">(Matrix a, Matrix b, <span class="keyword">int</span> r)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    Matrix ret;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r; i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= r; k++)</div><div class="line">            <span class="keyword">if</span>(a.m[i][k])</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= r; j++)</div><div class="line">                    <span class="keyword">if</span>(b.m[k][j])</div><div class="line">                        ret.m[i][j] = ( ret.m[i][j] + a.m[i][k] * b.m[k][j]) % mod;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Matrix <span class="title">M_qpow</span><span class="params">(Matrix P, LL n, <span class="keyword">int</span> r)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    Matrix ret;</div><div class="line">    ret.E();</div><div class="line">    <span class="keyword">while</span>(n)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(n &amp; <span class="number">1L</span>L) ret = M_mul(ret, P, r);</div><div class="line">        n &gt;&gt;= <span class="number">1L</span>L;</div><div class="line">        P = M_mul(P, P, r);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxn; i++) C[i][<span class="number">0</span>] = C[i][i] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; maxn; i++)</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++)</div><div class="line">            C[i][j] = (C[i<span class="number">-1</span>][j<span class="number">-1</span>] + C[i<span class="number">-1</span>][j]) % mod;</div><div class="line">    <span class="keyword">int</span> T;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T);</div><div class="line">    <span class="keyword">while</span>(T--)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> N, a, r;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;a, &amp;r);</div><div class="line">        Matrix M;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r; i++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j++)</div><div class="line">                M.m[i][j] = C[i][j] * a % mod;</div><div class="line">        M.m[r+<span class="number">1</span>][r] = M.m[r+<span class="number">1</span>][r+<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">        M = M_qpow(M, N, r + <span class="number">1</span>);</div><div class="line">        LL ans = <span class="number">0L</span>L;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r; i++) ans = (ans + M.m[r+<span class="number">1</span>][i] * a) % mod;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="B-Number-Busters-推公式"><a href="#B-Number-Busters-推公式" class="headerlink" title="B-Number Busters-推公式"></a>B-Number Busters-推公式</h2><ul>
<li>当$b&lt;x$时，$a$和$c$都会减小，$c - a$不会改变，所以只有在$b \geq x$的时候，才会使$a$和$c$之间的距离缩短，所以我们知道$b \geq x$这个状态共出现$c - a$秒。</li>
<li>再来看$b &lt; x$的时间，假设有$k$秒，且易知使$c = a$这个临界点出现的状态必然是$b \geq x$，此时（更新之后）$b$的值为$b - x <em> (c - a) + k </em> (w - x)$，那么这个值还原回去（加上$x$）必须大于等于$x$。</li>
<li>由此得出方程$b - x <em> (c - a) + k </em> (w - x) + x \geq x$</li>
<li>解出$k$，再加上$b \geq x$的时间$c - a$，就是最终的答案</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    ll a, b, w, x, c;</div><div class="line">    scan(a, b, w); scan(x, c);</div><div class="line">    ll ans = <span class="number">0L</span>L;</div><div class="line">    <span class="keyword">if</span>(c &gt; a) ans = <span class="built_in">ceil</span>(<span class="number">1.0</span> * ((c - a) * x - b) / (w - x)) + c - a;</div><div class="line">    dbg(ans);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="C-ZYB-loves-Xor-I-分治"><a href="#C-ZYB-loves-Xor-I-分治" class="headerlink" title="C-ZYB loves Xor I-分治"></a>C-ZYB loves Xor I-分治</h2><ul>
<li>这里的$lowbit(x)$的定义和我们以前知道的那个一样</li>
<li>网上的题解都是字典树，然而学艺不精</li>
<li>刘庆晖老师教导的分治的思维，让我看到了希望</li>
<li>对于一个数组$a$，我们考虑它的最低位是否为1，可以分为两个集合，这两个集合中任意两个数做异或的结果的$lowbit$，都是1。</li>
<li>对于第一个集合，由于最低位相同（都是1），那么考虑第二位（次低位），按照上面的描述再次分为两个集合，那么这两个集合中任意两个数的异或的$lowbit$都是2。</li>
<li>对于第二个集合同理。</li>
<li>之后对于再次划分的集合我们发现依然可以这样分治下去。</li>
<li>wow~</li>
<li>最后我们构造的就是一棵$2^n - 1$个节点的解答树</li>
<li>复杂度是$O(nlogn * T)$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">gao</span><span class="params">(vi &amp;vec, <span class="keyword">int</span> pos, ll &amp;ans)</span> </span>&#123;</div><div class="line">    vi vec1, vec2;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> v : vec) &#123;</div><div class="line">        <span class="keyword">if</span>(v &amp; (<span class="number">1</span> &lt;&lt; pos)) vec1.pb(v);</div><div class="line">        <span class="keyword">else</span> vec2.pb(v);</div><div class="line">    &#125;</div><div class="line">    ans += (ll)(<span class="number">1L</span>L &lt;&lt; pos) * vec1.size() * vec2.size() % MOD;</div><div class="line">    <span class="keyword">if</span>(pos &gt;= <span class="number">28</span>) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(vec1.size() &gt; <span class="number">0</span>) gao(vec1, pos + <span class="number">1</span>, ans);   <span class="comment">//剪枝很重要</span></div><div class="line">    <span class="keyword">if</span>(vec2.size() &gt; <span class="number">0</span>) gao(vec2, pos + <span class="number">1</span>, ans);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">int</span> T; scan(T);</div><div class="line">    rep(i, <span class="number">0</span>, T)</div><div class="line">    &#123;</div><div class="line">        vi vec;</div><div class="line">        <span class="keyword">int</span> n, x; scan(n);</div><div class="line">        <span class="keyword">while</span>(n--) &#123;</div><div class="line">            scan(x);</div><div class="line">            vec.pb(x);</div><div class="line">        &#125;</div><div class="line">        ll ans = <span class="number">0L</span>L;</div><div class="line">        gao(vec, <span class="number">0</span>, ans);</div><div class="line">        ans = ans * <span class="number">2L</span>L % MOD;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, i + <span class="number">1</span>, ans);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="D-Wavy-numbers-Q神代码"><a href="#D-Wavy-numbers-Q神代码" class="headerlink" title="D-Wavy numbers-Q神代码"></a>D-Wavy numbers-Q神代码</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ=<span class="number">10000000</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL=<span class="number">14</span>;</div><div class="line"><span class="keyword">int</span> vis[MAXQ],num[MAXL];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> now=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(t)</div><div class="line">    &#123;</div><div class="line">        num[now++]=t%<span class="number">10</span>;</div><div class="line">        t/=<span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> now;</div><div class="line">&#125;</div><div class="line"><span class="built_in">unordered_map</span>&lt;ll,<span class="keyword">int</span>&gt;mp[<span class="number">2</span>][<span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_right</span><span class="params">(ll n,ll &amp;k)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXQ;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> t=change(i),ok=<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(t==<span class="number">2</span>)ok&amp;=(num[<span class="number">0</span>]!=num[<span class="number">1</span>]);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;t<span class="number">-1</span>;j++)</div><div class="line">            ok&amp;=((num[j]&gt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&gt;num[j+<span class="number">1</span>])</div><div class="line">               ||(num[j]&lt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&lt;num[j+<span class="number">1</span>]));</div><div class="line">        <span class="keyword">if</span>(!ok)<span class="keyword">continue</span>;</div><div class="line">        vis[i]=<span class="number">1</span>;</div><div class="line">        k-=(i%n==<span class="number">0</span>);</div><div class="line">        <span class="keyword">if</span>(k==<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,i);</div><div class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(t==<span class="number">6</span> &amp;&amp; num[t<span class="number">-1</span>]&gt;num[t<span class="number">-2</span>])mp[<span class="number">0</span>][<span class="number">0</span>][i%n]++;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(t==<span class="number">7</span>)mp[num[t<span class="number">-1</span>]&gt;num[t<span class="number">-2</span>]][num[t<span class="number">-1</span>]][i%n]++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_res</span><span class="params">(ll n,ll &amp;k,ll Mod,<span class="keyword">int</span> lef)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> len=<span class="number">7</span>;</div><div class="line">    <span class="keyword">while</span>(lef)</div><div class="line">    &#123;</div><div class="line">        num[len++]=lef%<span class="number">10</span>;</div><div class="line">        lef/=<span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXQ;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!vis[i])<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">int</span> t=change(i),ok=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(t&lt;<span class="number">7</span>)num[t++]=<span class="number">0</span>;</div><div class="line">        t=len;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;t<span class="number">-1</span>;j++)</div><div class="line">            ok&amp;=((num[j]&gt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&gt;num[j+<span class="number">1</span>])</div><div class="line">               ||(num[j]&lt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&lt;num[j+<span class="number">1</span>]));</div><div class="line">        <span class="keyword">if</span>(!ok)<span class="keyword">continue</span>;</div><div class="line">        k-=(i%n==Mod);</div><div class="line">        <span class="keyword">if</span>(k==<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%07d"</span>,i);</div><div class="line">            <span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve_left</span><span class="params">(ll n,ll &amp;k)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXQ;i++)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(!vis[i])<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">int</span> t=change(i),ok=<span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(t==<span class="number">2</span>)ok&amp;=(num[<span class="number">0</span>]!=num[<span class="number">1</span>]);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;t<span class="number">-1</span>;j++)</div><div class="line">            ok&amp;=((num[j]&gt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&gt;num[j+<span class="number">1</span>])</div><div class="line">               ||(num[j]&lt;num[j<span class="number">-1</span>] &amp;&amp; num[j]&lt;num[j+<span class="number">1</span>]));</div><div class="line">        <span class="keyword">if</span>(!ok)<span class="keyword">continue</span>;</div><div class="line">        ll m=(n<span class="number">-1L</span>L*i*MAXQ%n)%n,cnt=<span class="number">0</span>;</div><div class="line">        <span class="keyword">if</span>(t==<span class="number">1</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;num[<span class="number">0</span>];j++)</div><div class="line">                <span class="keyword">if</span>(mp[<span class="number">0</span>][j].find(m)!=mp[<span class="number">0</span>][j].end())</div><div class="line">                    cnt+=mp[<span class="number">0</span>][j][m];</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=num[<span class="number">0</span>]+<span class="number">1</span>;j&lt;<span class="number">10</span>;j++)</div><div class="line">                <span class="keyword">if</span>(mp[<span class="number">1</span>][j].find(m)!=mp[<span class="number">1</span>][j].end())</div><div class="line">                    cnt+=mp[<span class="number">1</span>][j][m];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> go=(num[<span class="number">1</span>]&gt;num[<span class="number">0</span>]);</div><div class="line">            <span class="keyword">if</span>(go==<span class="number">0</span>)<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;num[<span class="number">0</span>];j++)</div><div class="line">                <span class="keyword">if</span>(mp[<span class="number">0</span>][j].find(m)!=mp[<span class="number">0</span>][j].end())</div><div class="line">                    cnt+=mp[<span class="number">0</span>][j][m];</div><div class="line">            <span class="keyword">if</span>(go==<span class="number">1</span>)<span class="keyword">for</span>(<span class="keyword">int</span> j=num[<span class="number">0</span>]+<span class="number">1</span>;j&lt;<span class="number">10</span>;j++)</div><div class="line">                <span class="keyword">if</span>(mp[<span class="number">1</span>][j].find(m)!=mp[<span class="number">1</span>][j].end())</div><div class="line">                    cnt+=mp[<span class="number">1</span>][j][m];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(k&lt;=cnt)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>,i);</div><div class="line">            get_res(n,k,m,i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> k-=cnt;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    ll n,k;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;k);</div><div class="line">    solve_right(n,k);</div><div class="line">    solve_left(n,k);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>*<span class="built_in">printf</span>(<span class="string">"-1"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="E-Bear-and-Floodlight-计算几何"><a href="#E-Bear-and-Floodlight-计算几何" class="headerlink" title="E-Bear and Floodlight-计算几何"></a>E-Bear and Floodlight-计算几何</h2><ul>
<li>只有20盏灯，所以可以考虑用状压dp，$dp[i]$表示$i$代表的状态（1表示亮）能走的最远距离</li>
<li>转移就是枚举剩下的未亮的灯，点亮后能走的距离。</li>
<li>对于状态$dp[i]$点亮灯$j$之后的状态分两种情况：<ul>
<li>由$dp[i]$的终点开始向$r$照亮$\theta_j$的范围，那么有$dp[i | (1 &lt;&lt; j)] = (arctan((dp[i] - x_j) / y_j) + \theta_j) * y_j + x_j - l$</li>
<li>若该角度超过r，则取$r - l$</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">double</span> l, r;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y, ang;</div><div class="line">    point() &#123;&#125;</div><div class="line">    point(<span class="keyword">double</span> _x, <span class="keyword">double</span> _y, <span class="keyword">double</span> _ang) &#123;</div><div class="line">        x = _x - l;</div><div class="line">        y = <span class="built_in">fabs</span>(_y);</div><div class="line">        ang = _ang * pi / <span class="number">180.0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;p[maxn];</div><div class="line"><span class="keyword">double</span> dp[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">int</span> n; scan(n); scan(l, r);</div><div class="line">    r -= l;</div><div class="line">    rep(i, <span class="number">0</span>, n) &#123;</div><div class="line">        <span class="keyword">double</span> x, y, ang;</div><div class="line">        scan(x, y, ang);</div><div class="line">        p[i] = point(x, y, ang);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    rep(i, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; n)) &#123;</div><div class="line">        rep(j, <span class="number">0</span>, n) &#123;</div><div class="line">            <span class="keyword">if</span>((i &amp; (<span class="number">1</span> &lt;&lt; j)) == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">double</span> tmp = <span class="built_in">atan</span>((r - p[j].x) / p[j].y);</div><div class="line">                tmp = min(tmp, <span class="built_in">atan</span>((dp[i] - p[j].x) / p[j].y) + p[j].ang);</div><div class="line">                dp[i | (<span class="number">1</span> &lt;&lt; j)] = max(dp[i | (<span class="number">1</span> &lt;&lt; j)], p[j].x + p[j].y * <span class="built_in">tan</span>(tmp));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%.9f\n"</span>, dp[(<span class="number">1</span> &lt;&lt; n) - <span class="number">1</span>]);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="F-Subway-Innovation-前缀和优化-数学推导"><a href="#F-Subway-Innovation-前缀和优化-数学推导" class="headerlink" title="F-Subway Innovation-前缀和优化+数学推导"></a>F-Subway Innovation-前缀和优化+数学推导</h2><ul>
<li>如果这$n$个点是按照$x$坐标排好序的，那么我们很容易知道，两两距离之和最短的$k$个点一定是连续的（反证一下即可）</li>
<li>首先用前缀和处理一下$x$坐标的和，即$sum[i]$表示前$i$个点的$x$坐标之和</li>
<li>令$f(i)$表示从$i$开始的$k$个点两两之间的距离之和，我们先求出$f(0)$</li>
<li>添加辅助函数$h(i)$表示前$i$个点两两间的距离之和，有$h(i) = h(i - 1) + x_i * i - sum[i - 1]$($i$从$0$开始)</li>
<li>我们令$f(0) = h(k - 1)$</li>
<li>接下来推导$f$的转移关系，可以看出$f(i)$到$f(i - 1)$，多出了$x_{i + k - 1}$到$x<em>i…x</em>{i + k - 2}$的距离，减少了$x_{i - 1}$到$x<em>i…x</em>{i + k - 2}$的距离</li>
<li>$f(i) = f(i - 1)-(sum[i + k - 2] - sum[i - 1] - x<em>{i - 1} * (k - 1)) + x</em>{i + k - 2} * k - sum[i + k - 1] + sum[i - 1]$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> id;</div><div class="line">    ll x;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> point &amp;b) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> x &lt; b.x;</div><div class="line">    &#125;</div><div class="line">&#125;p[maxn];</div><div class="line">ll sum[maxn], dp[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">int</span> n, k; scan(n);</div><div class="line">    rep(i, <span class="number">0</span>, n) &#123;</div><div class="line">        scan(p[i].x);</div><div class="line">        p[i].id = i;</div><div class="line">    &#125;</div><div class="line">    sort(p, p + n);</div><div class="line">    sum[<span class="number">0</span>] = p[<span class="number">0</span>].x;</div><div class="line">    rep(i, <span class="number">1</span>, n) sum[i] = sum[i - <span class="number">1</span>] + p[i].x;</div><div class="line">    scan(k);</div><div class="line"></div><div class="line">    rep(i, <span class="number">1</span>, k) dp[i] = dp[i - <span class="number">1</span>] + p[i].x * i - sum[i - <span class="number">1</span>];</div><div class="line">    dp[<span class="number">0</span>] = dp[k - <span class="number">1</span>];</div><div class="line">    ll ans = dp[<span class="number">0</span>], l = <span class="number">0</span>;</div><div class="line">    rep(i, <span class="number">1</span>, n - k + <span class="number">1</span>) &#123;</div><div class="line">        dp[i] = dp[i - <span class="number">1</span>] - (sum[i + k - <span class="number">2</span>] - sum[i - <span class="number">1</span>] - p[i - <span class="number">1</span>].x * (k - <span class="number">1</span>)) + (p[i + k - <span class="number">1</span>].x * (k - <span class="number">1</span>) - (sum[i + k - <span class="number">2</span>] - sum[i - <span class="number">1</span>]));</div><div class="line">        <span class="keyword">if</span>(ans &gt; dp[i]) &#123;</div><div class="line">            ans = dp[i];</div><div class="line">            l = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    rep(i, l, l + k) <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, p[i].id + <span class="number">1</span>, i == l + k - <span class="number">1</span> ? <span class="string">'\n'</span> : <span class="string">' '</span>);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="G-Dexterina’s-Lab-矩阵优化-概率dp"><a href="#G-Dexterina’s-Lab-矩阵优化-概率dp" class="headerlink" title="G-Dexterina’s Lab-矩阵优化+概率dp"></a>G-Dexterina’s Lab-矩阵优化+概率dp</h2><ul>
<li>$dp[i][j] = \displaystyle{\sum_{k = 0}^{127}dp[i-1][k]*p[j\wedge k]}$</li>
<li>$\begin{pmatrix} dp[i][0] \ dp[i][1]\.\.\.\dp[i][127]\end{pmatrix} = \begin{pmatrix}p[0][0] &amp;&amp;p[0][1]&amp;&amp;…&amp;&amp;p[0][127]\p[1][0] &amp;&amp;p[1][1]&amp;&amp;…&amp;&amp;p[1][127]\.&amp;&amp;.&amp;&amp;…&amp;&amp;.\.&amp;&amp;.&amp;&amp;…&amp;&amp;.\.&amp;&amp;.&amp;&amp;…&amp;&amp;.\p[127][0] &amp;&amp;p[127][1]&amp;&amp;…&amp;&amp;p[127][127]\\end{pmatrix}\begin{pmatrix} dp[i-1][0] \ dp[i-1][1]\.\.\.\dp[i-1][127]\end{pmatrix}$</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n, K;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span>&#123;</span></div><div class="line">	<span class="keyword">double</span> x[<span class="number">128</span>][<span class="number">128</span>];</div><div class="line">&#125;A,B,ans;</div><div class="line">Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;k1, <span class="keyword">const</span> Matrix &amp;k2) &#123;</div><div class="line">	mem(B.x, <span class="number">0</span>);</div><div class="line">	rep(i, <span class="number">0</span>, n + <span class="number">1</span>)</div><div class="line">		rep(j, <span class="number">0</span>, n + <span class="number">1</span>)</div><div class="line">			rep(k, <span class="number">0</span>, n + <span class="number">1</span>)</div><div class="line">				B.x[i][j] += k1.x[i][k] * k2.x[k][j];</div><div class="line">	<span class="keyword">return</span> B;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    scan(K, n);</div><div class="line">	rep(i, <span class="number">0</span>, n + <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">double</span> k1; scan(k1);</div><div class="line">		rep(j, <span class="number">0</span>, <span class="number">128</span>) A.x[j][i^j]=k1;</div><div class="line">	&#125;</div><div class="line">	n = <span class="number">127</span>;</div><div class="line">	ans=A; K--;</div><div class="line">	<span class="keyword">while</span> (K) &#123;</div><div class="line">		<span class="keyword">if</span> (K &amp; <span class="number">1</span>) ans = ans * A; A = A * A; K &gt;&gt;= <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%.11lf\n"</span>,<span class="number">1</span> - ans.x[<span class="number">0</span>][<span class="number">0</span>]);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="H-Count-Good-Substrings-机智"><a href="#H-Count-Good-Substrings-机智" class="headerlink" title="H-Count Good Substrings-机智"></a>H-Count Good Substrings-机智</h2><ul>
<li>根据描述最后的串一定是abababa这个样子</li>
<li>若是回文串那么首尾字母一定相同</li>
<li>偶数长度的回文串的来源<ul>
<li>一个奇数位置的a和一个偶数位置的a之间</li>
<li>一个奇数位置的b和一个偶数位置的b之间</li>
</ul>
</li>
<li>奇数长度的回文串来源<ul>
<li>任意位置的奇偶性相同的两个a或两个b之间的串</li>
<li>单一字符</li>
</ul>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function">ll <span class="title">gao</span><span class="params">(ll n)</span> </span>&#123; <span class="keyword">return</span> n * (n - <span class="number">1</span>) / <span class="number">2L</span>L; &#125;</div><div class="line"><span class="keyword">char</span> s[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    scan(s);</div><div class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s);</div><div class="line">    ll oa = <span class="number">0L</span>L, ea = <span class="number">0L</span>L, ob = <span class="number">0L</span>L, eb = <span class="number">0L</span>L;</div><div class="line">    rep(i, <span class="number">0</span>, n) &#123;</div><div class="line">        <span class="keyword">if</span>(i &amp; <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">if</span>(s[i] == <span class="string">'a'</span>) oa++;</div><div class="line">            <span class="keyword">else</span> ob++;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span>(s[i] == <span class="string">'a'</span>) ea++;</div><div class="line">            <span class="keyword">else</span> eb++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    dbg(oa * ea + ob * eb);</div><div class="line">    dbg(gao(oa) + gao(ob) + gao(ea) + gao(eb) + n);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="I-Divisors-模拟"><a href="#I-Divisors-模拟" class="headerlink" title="I-Divisors-模拟"></a>I-Divisors-模拟</h2><ul>
<li>先$O(\sqrt x )$预处理出$x$的所有因子并且排序，再根据题目描述dfs模拟一下就行</li>
<li>注意对因子去重什么的，免得平方根因子不好搞</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>, mnt = <span class="number">0</span>;</div><div class="line">ll fac[maxn];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">gao</span><span class="params">(ll x, ll k)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(cnt &gt; <span class="number">99999</span>) <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(x == <span class="number">1L</span>L || k == <span class="number">0L</span>L) &#123; dbg(x); cnt++; <span class="keyword">return</span>; &#125;</div><div class="line">    rep(i, <span class="number">0</span>, mnt) &#123;</div><div class="line">        <span class="keyword">if</span>(x &lt; fac[i]) <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">if</span>(x % fac[i] == <span class="number">0</span>) gao(fac[i], k - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    ll x, k; scan(x, k);</div><div class="line">    <span class="keyword">for</span>(ll i = <span class="number">1L</span>L; i * i &lt;= x; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(x % i == <span class="number">0</span>) &#123;</div><div class="line">            fac[mnt++] = i;</div><div class="line">            fac[mnt++] = x / i;</div><div class="line">        &#125; </div><div class="line">    &#125;</div><div class="line">    mnt = unique(fac, fac + mnt) - fac;</div><div class="line">    sort(fac, fac + mnt);</div><div class="line">    gao(x, k);</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="J-Painting-Fence-分治"><a href="#J-Painting-Fence-分治" class="headerlink" title="J-Painting Fence-分治"></a>J-Painting Fence-分治</h2><ul>
<li>一个问题的定义，就是找到这个区间中的最短板，把这个长度以下部分横着刷，剩下的以他为中心分为两个区间，每个区间又是相同的子问题</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> a[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">gao</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> minn)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt; r) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> a[l] &gt; minn;</div><div class="line">    <span class="keyword">int</span> m = min_element(a + l, a + r + <span class="number">1</span>) - a;</div><div class="line">    <span class="keyword">return</span> min(r - l + <span class="number">1</span>, gao(l, m - <span class="number">1</span>, a[m]) + gao(m + <span class="number">1</span>, r, a[m]) + a[m] - minn);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        freopen(<span class="string">"in.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">        freopen(<span class="string">"out.txt"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">        <span class="keyword">long</span> _begin_time = clock();</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">int</span> n; scan(n);</div><div class="line">    rep(i, <span class="number">1</span>, n + <span class="number">1</span>) scan(a[i]);</div><div class="line">    dbg(gao(<span class="number">1</span>, n, <span class="number">0</span>));</div><div class="line">    </div><div class="line">    <span class="meta">#<span class="meta-keyword">ifndef</span> ONLINE_JUDGE</span></div><div class="line">        <span class="keyword">long</span> _end_time = clock();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"time = %ld ms\n"</span>, _end_time - _begin_time);</div><div class="line">    <span class="meta">#<span class="meta-keyword">endif</span></span></div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/STACK:1024000000,1024000000"</span>)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> fi first</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> se second</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MP(A, B) make_pair(A, B)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> pb push_back</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> gcd __gcd</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> foreach(it,a) for(__typeof((a).begin()) it=(a).begin();it!=(a).end();it++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, a, b) for(int i = a; i &lt; b; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> per(i, a, b) for(int i = a; i &gt; b; i--)</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ulls;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">int</span> uint;</div><div class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; pii;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;pii&gt; vii;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mii;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; msi;</div><div class="line"><span class="keyword">typedef</span> <span class="built_in">map</span>&lt;pii, <span class="keyword">int</span>&gt; mpi;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">const</span> ll LINF = <span class="number">0x3f3f3f3f3f3f3f3f</span>LL;</div><div class="line"><span class="keyword">const</span> ll MOD = <span class="number">998244353</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e6</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxm = <span class="number">1e6</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> dx[] = &#123;<span class="number">-1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> dy[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">int</span> &amp;a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;a, &amp;b); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b, <span class="keyword">int</span> &amp;c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;a, &amp;b, &amp;c); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(ll &amp;a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%I64d"</span>, &amp;a); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(ll &amp;a, ll &amp;b)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%I64d%I64d"</span>, &amp;a, &amp;b); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(ll &amp;a, ll &amp;b, ll &amp;c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%I64d%I64d%I64d"</span>, &amp;a, &amp;b, &amp;c); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">double</span> &amp;a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;a); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">double</span> &amp;a, <span class="keyword">double</span> &amp;b)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;a, &amp;b); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">double</span> &amp;a, <span class="keyword">double</span> &amp;b, <span class="keyword">double</span> &amp;c)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf"</span>, &amp;a, &amp;b, &amp;c); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">char</span> &amp;a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%c"</span>, &amp;a); &#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">scan</span><span class="params">(<span class="keyword">char</span> *a)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">scanf</span>(<span class="string">"%s"</span>, a); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T</span> &amp;<span class="title">A</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> <span class="built_in">memset</span>(A, x, <span class="keyword">sizeof</span>(A)); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>, <span class="title">class</span> <span class="title">T2</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">T2</span> &amp;<span class="title">A2</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x), mem(A2, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>, <span class="title">class</span> <span class="title">T2</span>, <span class="title">class</span> <span class="title">T3</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">T2</span> &amp;<span class="title">A2</span>, <span class="title">T3</span> &amp;<span class="title">A3</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x), mem(A2, x), mem(A3, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>, <span class="title">class</span> <span class="title">T2</span>, <span class="title">class</span> <span class="title">T3</span>, <span class="title">class</span> <span class="title">T4</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">T2</span> &amp;<span class="title">A2</span>, <span class="title">T3</span> &amp;<span class="title">A3</span>, <span class="title">T4</span> &amp;<span class="title">A4</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x), mem(A2, x), mem(A3, x), mem(A4, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>, <span class="title">class</span> <span class="title">T2</span>, <span class="title">class</span> <span class="title">T3</span>, <span class="title">class</span> <span class="title">T4</span>, <span class="title">class</span> <span class="title">T5</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">T2</span> &amp;<span class="title">A2</span>, <span class="title">T3</span> &amp;<span class="title">A3</span>, <span class="title">T4</span> &amp;<span class="title">A4</span>, <span class="title">T5</span> &amp;<span class="title">A5</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x), mem(A2, x), mem(A3, x), mem(A4, x), mem(A5, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T0</span>, <span class="title">class</span> <span class="title">T1</span>, <span class="title">class</span> <span class="title">T2</span>, <span class="title">class</span> <span class="title">T3</span>, <span class="title">class</span> <span class="title">T4</span>, <span class="title">class</span> <span class="title">T5</span>, <span class="title">class</span> <span class="title">T6</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">mem</span>(<span class="title">T0</span> &amp;<span class="title">A0</span>, <span class="title">T1</span> &amp;<span class="title">A1</span>, <span class="title">T2</span> &amp;<span class="title">A2</span>, <span class="title">T3</span> &amp;<span class="title">A3</span>, <span class="title">T4</span> &amp;<span class="title">A4</span>, <span class="title">T5</span> &amp;<span class="title">A5</span>, <span class="title">T6</span> &amp;<span class="title">A6</span>, <span class="title">int</span> <span class="title">x</span>) &#123;</span> mem(A0, x), mem(A1, x), mem(A2, x), mem(A3, x), mem(A4, x), mem(A5, x), mem(A6, x); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">min</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>) &#123;</span> <span class="keyword">return</span> min(min(a, b), c); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">max</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>) &#123;</span> <span class="keyword">return</span> max(max(a, b), c); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">min</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>, <span class="title">T</span> <span class="title">d</span>) &#123;</span> <span class="keyword">return</span> min(min(a, b), min(c, d)); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">max</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>, <span class="title">T</span> <span class="title">d</span>) &#123;</span> <span class="keyword">return</span> max(max(a, b), max(c, d)); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">min</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>, <span class="title">T</span> <span class="title">d</span>, <span class="title">T</span> <span class="title">e</span>) &#123;</span> <span class="keyword">return</span> min(min(min(a,b),min(c,d)),e); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">T</span> <span class="title">max</span>(<span class="title">T</span> <span class="title">a</span>, <span class="title">T</span> <span class="title">b</span>, <span class="title">T</span> <span class="title">c</span>, <span class="title">T</span> <span class="title">d</span>, <span class="title">T</span> <span class="title">e</span>) &#123;</span> <span class="keyword">return</span> max(max(max(a,b),max(c,d)),e); &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">dbg</span>(<span class="title">T</span> <span class="title">a</span>[], <span class="title">int</span> <span class="title">n</span>) &#123;</span> rep(i, <span class="number">0</span>, n) <span class="built_in">cout</span> &lt;&lt; a[i] &lt;&lt; (i == n - <span class="number">1</span> ? <span class="string">"\n"</span> : <span class="string">" "</span>);&#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">dbg</span>(<span class="title">T</span> <span class="title">a</span>) &#123;</span> <span class="built_in">cout</span> &lt;&lt; a &lt;&lt; <span class="string">" "</span>; &#125;</div><div class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">dbg</span>(<span class="title">T</span> <span class="title">a</span>[][<span class="title">maxn</span>], <span class="title">int</span> <span class="title">n</span>, <span class="title">int</span> <span class="title">m</span>) &#123;</span> rep(i, <span class="number">0</span>, n) rep(j, <span class="number">0</span>, m) <span class="built_in">cout</span> &lt;&lt; a[i][j] &lt;&lt; (j == m - <span class="number">1</span> ? <span class="string">"\n"</span> : <span class="string">" "</span>); &#125;</div></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/09/11/hello-world/" rel="next" title="Hello World">
                <i class="fa fa-chevron-left"></i> Hello World
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">CFhM_R</p>
            <p class="site-description motion-element" itemprop="description">所谓的光辉岁月，不是那些闪耀的日子，而是无人问津时，你对梦想的坚持</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第二期第四次每周训练题解"><span class="nav-number">1.</span> <span class="nav-text">第二期第四次每周训练题解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#A-Moon-Safari-medium-数论"><span class="nav-number">1.1.</span> <span class="nav-text">A-Moon Safari (medium)-数论</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#B-Number-Busters-推公式"><span class="nav-number">1.2.</span> <span class="nav-text">B-Number Busters-推公式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#C-ZYB-loves-Xor-I-分治"><span class="nav-number">1.3.</span> <span class="nav-text">C-ZYB loves Xor I-分治</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#D-Wavy-numbers-Q神代码"><span class="nav-number">1.4.</span> <span class="nav-text">D-Wavy numbers-Q神代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#E-Bear-and-Floodlight-计算几何"><span class="nav-number">1.5.</span> <span class="nav-text">E-Bear and Floodlight-计算几何</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#F-Subway-Innovation-前缀和优化-数学推导"><span class="nav-number">1.6.</span> <span class="nav-text">F-Subway Innovation-前缀和优化+数学推导</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#G-Dexterina’s-Lab-矩阵优化-概率dp"><span class="nav-number">1.7.</span> <span class="nav-text">G-Dexterina’s Lab-矩阵优化+概率dp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#H-Count-Good-Substrings-机智"><span class="nav-number">1.8.</span> <span class="nav-text">H-Count Good Substrings-机智</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#I-Divisors-模拟"><span class="nav-number">1.9.</span> <span class="nav-text">I-Divisors-模拟</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#J-Painting-Fence-分治"><span class="nav-number">1.10.</span> <span class="nav-text">J-Painting Fence-分治</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#头文件"><span class="nav-number">1.11.</span> <span class="nav-text">头文件</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CFhM_R</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动</div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">主题 &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
